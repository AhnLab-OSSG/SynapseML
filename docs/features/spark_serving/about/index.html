<!doctype html>
<html class="docs-version-0.9.5" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/SynapseML/blog/rss.xml" title="SynapseML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/SynapseML/blog/atom.xml" title="SynapseML Atom Feed">
<link rel="alternate" type="application/json" href="/SynapseML/blog/feed.json" title="SynapseML JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RWPE0183E8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RWPE0183E8",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="SynapseML" href="/SynapseML/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Spark Serving | SynapseML</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-react-helmet="true" name="twitter:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-react-helmet="true" property="og:url" content="https://microsoft.github.io/SynapseML/docs/features/spark_serving/about/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.9.5"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.9.5"><meta data-react-helmet="true" property="og:title" content="Spark Serving | SynapseML"><meta data-react-helmet="true" name="description" content="An Engine for Deploying Spark Jobs as Distributed Web Services"><meta data-react-helmet="true" property="og:description" content="An Engine for Deploying Spark Jobs as Distributed Web Services"><link data-react-helmet="true" rel="icon" href="/SynapseML/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://microsoft.github.io/SynapseML/docs/features/spark_serving/about/"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/features/spark_serving/about/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/features/spark_serving/about/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://GBW8AA15RD-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/SynapseML/assets/css/styles.074bcd8f.css">
<link rel="preload" href="/SynapseML/assets/js/runtime~main.1b6b9565.js" as="script">
<link rel="preload" href="/SynapseML/assets/js/main.96d01756.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" role="banner"><div class="announcementBarPlaceholder_2m9F"></div><div class="announcementBarContent_3EUC">⭐️ If you like SynapseML, consider giving it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/Microsoft/SynapseML">GitHub</a> ⭐</div><button type="button" class="clean-btn close announcementBarClose_38nx" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/SynapseML/"><div class="navbar__logo"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">SynapseML</b></a><a class="navbar__item navbar__link" href="/SynapseML/docs/about/">Docs</a><a class="navbar__item navbar__link" href="/SynapseML/blog/">Blog</a><a class="navbar__item navbar__link" href="/SynapseML/videos/">Videos</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/SynapseML/docs/about/">0.9.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/SynapseML/docs/next/features/spark_serving/about/">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/SynapseML/docs/features/spark_serving/about/">0.9.5</a></li><li><a class="dropdown__link" href="/SynapseML/docs/0.9.4/features/spark_serving/about/">0.9.4</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/SynapseML/docs/features/spark_serving/about/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Developer Docs</a><ul class="dropdown__menu"><li><a href="https://mmlspark.blob.core.windows.net/docs/0.9.5/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Python<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://mmlspark.blob.core.windows.net/docs/0.9.5/scala/com/microsoft/azure/synapse/ml/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Scala<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_71bT toggle_3Zt9 toggleChecked_2FvV toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" checked="" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Kl_"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SynapseML/docs/about/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/SynapseML/docs/getting_started/installation/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/SynapseML/docs/features/cognitive_services/CognitiveServices - Analyze Text/">Features</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/cognitive_services/CognitiveServices - Analyze Text/">Cognitive Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/geospatial_services/GeospatialServices - Flooding Risk/">Geospatial Services</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/responsible_ai/Data Balance Analysis/">Responsible AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/onnx/about/">ONNX</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/lightgbm/about/">LightGBM</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/vw/about/">Vowpal Wabbit</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/spark_serving/about/">Spark Serving</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SynapseML/docs/features/spark_serving/about/">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/features/spark_serving/SparkServing - Deploying a Classifier/">SparkServing - Deploying a Classifier</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/opencv/OpenCV - Pipeline Image Transformations/">OpenCV</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/classification/Classification - Adult Census with Vowpal Wabbit/">Classification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/regression/Regression - Auto Imports/">Regression</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" tabindex="0" href="/SynapseML/docs/features/other/AzureSearchIndex - Met Artworks/">Other</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/SynapseML/docs/documentation/transformers/transformers_cognitive/">Transformers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/SynapseML/docs/documentation/estimators/estimators_cognitive/">Estimators</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/SynapseML/docs/reference/developer-readme/">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->0.9.5</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><img src="https://mmlspark.blob.core.windows.net/graphics/SparkServing3.svg" width="90" align="left"><header><h1>Spark Serving</h1></header><h3 class="anchor anchorWithStickyNavbar_31ik" id="an-engine-for-deploying-spark-jobs-as-distributed-web-services">An Engine for Deploying Spark Jobs as Distributed Web Services<a class="hash-link" href="#an-engine-for-deploying-spark-jobs-as-distributed-web-services" title="Direct link to heading">​</a></h3><ul><li><strong>Distributed</strong>: Takes full advantage of Node, JVM, and thread level
parallelism that Spark is famous for.</li><li><strong>Fast</strong>: No single node bottlenecks, no round trips to Python.
Requests can be routed directly to and from worker JVMs through
network switches.  Spin up a web service in a matter of seconds. </li><li><strong>Low Latency</strong>: When using continuous serving,
you can achieve latencies as low as 1 millisecond.</li><li><strong>Deployable Anywhere</strong>: Works anywhere that runs Spark such as
Databricks, HDInsight, AZTK, DSVMs, local, or on your own
cluster.  Usable from Spark, PySpark, and SparklyR.</li><li><strong>Lightweight</strong>: No dependence on additional (costly) Kafka or
Kubernetes clusters.</li><li><strong>Idiomatic</strong>: Uses the same API as batch and structured streaming.</li><li><strong>Flexible</strong>: Spin up and manage several services on a single Spark
cluster.  Synchronous and Asynchronous service management and
extensibility.  Deploy any spark job that is expressible as a
structured streaming query.  Use serving sources/sinks with other
Spark data sources/sinks for more complex deployments.</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="usage">Usage<a class="hash-link" href="#usage" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="jupyter-notebook-examples">Jupyter Notebook Examples<a class="hash-link" href="#jupyter-notebook-examples" title="Direct link to heading">​</a></h3><ul><li><a href="/SynapseML/docs/features/spark_serving/SparkServing - Deploying a Classifier/">Deploy a classifier trained on the Adult Census Dataset</a></li><li>More coming soon!</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="spark-serving-hello-world">Spark Serving Hello World<a class="hash-link" href="#spark-serving-hello-world" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">import</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> pyspark</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">functions </span><span class="token keyword">import</span><span class="token plain"> udf</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> col</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> length</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">types </span><span class="token keyword">import</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">readStream</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(174, 129, 255)">8888</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;my_api&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">parseRequest</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">StructType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;bar&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> IntegerType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">replies </span><span class="token operator">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">withColumn</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;fooLength&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> length</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">col</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;foo&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain">\</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">makeReply</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;fooLength&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">server </span><span class="token operator">=</span><span class="token plain"> replies\</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">writeStream \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">replyTo</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;my_api&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">queryName</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;my_query&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">option</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;checkpointLocation&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;file:///path/to/checkpoints&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="deploying-a-deep-network-with-the-cntkmodel">Deploying a Deep Network with the CNTKModel<a class="hash-link" href="#deploying-a-deep-network-with-the-cntkmodel" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP language-python theme-code-block"><div class="codeBlockContent_hGly python"><pre tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">import</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">cntk </span><span class="token keyword">import</span><span class="token plain"> CNTKModel</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> pyspark</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">functions </span><span class="token keyword">import</span><span class="token plain"> udf</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> col</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">readStream</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">address</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;localhost&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(174, 129, 255)">8888</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;my_api&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">parseRequest</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token operator">&lt;</span><span class="token plain">Insert your models </span><span class="token builtin" style="color:rgb(174, 129, 255)">input</span><span class="token plain"> schema here</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)"># See notebook examples for how to create and save several</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:rgb(136, 132, 111)"># examples of CNTK models</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">network </span><span class="token operator">=</span><span class="token plain"> CNTKModel</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;file:///path/to/my_cntkmodel.mml&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">transformed_df </span><span class="token operator">=</span><span class="token plain"> network</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">makeReply</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token operator">&lt;</span><span class="token plain">Whatever column you wish to send back</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">server </span><span class="token operator">=</span><span class="token plain"> transformed_df \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">writeStream \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">server</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">replyTo</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;my_api&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">queryName</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;my_query&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">option</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;checkpointLocation&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(230, 219, 116)">&quot;file:///path/to/checkpoints&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">           </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">start</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="architecture">Architecture<a class="hash-link" href="#architecture" title="Direct link to heading">​</a></h2><p>Spark Serving adds special streaming sources sinks to turn any
structured streaming job into a web service.  Spark Serving comes
with two deployment options that vary based on the load balancing used:</p><p>In brief you can use the following:
<code>spark.readStream.server()</code>: For head node load balanced services
<code>spark.readStream.distributedServer()</code>: For custom load balanced services
<code>spark.readStream.continuousServer()</code>: For a custom load balanced, sub-millisecond latency continuous server</p><p>To create the various different serving dataframes and use the equivalent statements after <code>df.writeStream</code>
for replying to the web requests</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="head-node-load-balanced">Head Node Load Balanced<a class="hash-link" href="#head-node-load-balanced" title="Direct link to heading">​</a></h3><p>You can deploy head node load balancing with the <code>HTTPSource</code> and
<code>HTTPSink</code> classes.  This mode spins up a queue on the head node,
distributes work across partitions, then collects response data back to
the head node.  All HTTP requests are kept and replied to on the head
node. In both python and Scala these classes can be access by using
<code>spark.readStream.server()</code> after importing SynapseML.
This mode allows for more complex windowing, repartitioning, and
SQL operations.  This option is also idea for rapid setup and testing,
as it doesn&#x27;t require any additional load balancing or network
switches.A diagram of this configuration can be seen below:</p><p align="center"><img src="https://mmlspark.blob.core.windows.net/graphics/HeadNodeDistributed2.png" width="600"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="fully-distributed-custom-load-balancer">Fully Distributed (Custom Load Balancer)<a class="hash-link" href="#fully-distributed-custom-load-balancer" title="Direct link to heading">​</a></h3><p>You can configure Spark Serving for a custom load balancer using the
<code>DistributedHTTPSource</code> and <code>DistributedHTTPSink</code> classes.  This mode
spins up servers on each executor JVM.<br>
<!-- -->In both python and Scala these classes can be access by using
<code>spark.readStream.distributedServer()</code> after importing SynapseML.
Each server will feed its
executor&#x27;s partitions in parallel.  This mode is key for high throughput
and low latency as data does not need to be transferred to and from the
head node.  This deployment results in several web services that all
route into the same spark computation.  You can deploy an external load
balancer to unify the executor&#x27;s services under a single IP address.
Support for automatic load balancer management and deployment is
targeted for the next release of SynapseML.  A diagram of this
configuration can be seen below:</p><p align="center"><img src="https://mmlspark.blob.core.windows.net/graphics/FullyDistributed2.png" width="600"></p><p>Queries that involve data movement across workers, such as a nontrivial
SQL join, need special consideration.  The user must ensure that the
right machine replies to each request.  One can route data back to the
originating partition with a broadcast join.  In the future, request
routing will be automatically handled by the sink.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="sub-millisecond-latency-with-continuous-processing">Sub-Millisecond Latency with Continuous Processing<a class="hash-link" href="#sub-millisecond-latency-with-continuous-processing" title="Direct link to heading">​</a></h3><p align="center"><img src="https://mmlspark.blob.core.windows.net/graphics/latency_comparison.png" width="600"></p><p>Continuous processing can be enabled by hooking into the <code>HTTPSourceV2</code> class using:</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#f8f8f2"><span class="token plain">spark.readStream.continuousServer()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  ...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that in continuous serving, much like continuous streaming you need to add a trigger to your write statement:</p><div class="codeBlockContainer_K1bP theme-code-block"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#f8f8f2"><span class="token plain"> df.writeStream</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  .continuousServer()</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  .trigger(continuous=&quot;1 second&quot;)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  ...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The architecture is very similiar to the custom load balancer setup described above.
More specifically, Spark will manage a web service on each partition.
These webservices can be unified together using an Azure Load Balancer,
Kubernetes Service Endpoint, Azure Application gateway or any other way to load balance a distributed service.
It is currently the user&#x27;s responsibility to optionally unify these services as they see fit.
In the furutre we will include options to dynamically spin up and manage a load balancer.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="databricks-setup">Databricks Setup<a class="hash-link" href="#databricks-setup" title="Direct link to heading">​</a></h4><p>Databricks is a managed architecture and they have restricted
all incoming traffic to the nodes of the cluster.
If you create a web service in your databricks cluster (head or worker nodes),
your cluster can communicate with the service, but the outside world cannot.
However, In the future, Databricks will support Virtual Network Injection so this will not be a problem.
In the meantime, you must use SSH tunneling to forward the services to another machine(s)
to act as a networking gateway. This machine can be any machine that accpets SSH traffic and requests.
We have included settings to automatically configure this SSH tunneling for convenience.</p><h5 class="anchor anchorWithStickyNavbar_31ik" id="linux-gateway-setup---azure">Linux Gateway Setup - Azure<a class="hash-link" href="#linux-gateway-setup---azure" title="Direct link to heading">​</a></h5><ol><li><a href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/quick-create-portal" target="_blank" rel="noopener noreferrer">Create a Linux VM using SSH</a></li><li><a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/nsg-quickstart-portal" target="_blank" rel="noopener noreferrer">Open ports 8000-9999 from the Azure Portal</a></li><li>Open the port on the firewall on the VM<div class="codeBlockContainer_K1bP language-$xslt theme-code-block"><div class="codeBlockContent_hGly $xslt"><pre tabindex="0" class="prism-code language-$xslt codeBlock_23N8 thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#f8f8f2"><span class="token plain">firewall-cmd --zone=public --add-port=8000-10000/tcp --permanent</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">firewall-cmd --reload</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">echo &quot;GatewayPorts yes&quot; &gt;&gt; /etc/ssh/sshd_config</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">service ssh --full-restart</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li>Add your private key to a private container in <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-quickstart-create-account?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&amp;tabs=portal" target="_blank" rel="noopener noreferrer">Azure Storage Blob</a>.</li><li>Generate a SAS link for your key and save it.</li><li>Simply include the following parameters on your reader to configure the SSH tunneling:
serving_inputs = (spark.readStream.continuousServer()
.option(&quot;numPartitions&quot;, 1)
.option(&quot;forwarding.enabled&quot;, True)  # enable ssh forwarding to a gateway machine
.option(&quot;forwarding.username&quot;, &quot;username&quot;)
.option(&quot;forwarding.sshHost&quot;, &quot;ip or dns&quot;)
.option(&quot;forwarding.keySas&quot;, &quot;SAS url from the previous step&quot;)
.address(&quot;localhost&quot;, 8904, &quot;my_api&quot;)
.load() </li></ol><p>Note that this will make your service require an extra jump and affect latency.
It is important to pick a gateway that has good connectivity to your spark cluster.
For this reason we suggest using Spark Serving
on a cluster enviromnent that is more open such as Kubernetes, Mesos, or Azure Batch
for best performance and ease of configuration.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">​</a></h2><table><thead><tr><th>Parameter Name</th><th>Description</th><th>Necessary</th><th>Default Value</th><th>Applicable When</th></tr></thead><tbody><tr><td>host</td><td>The host to spin up a server on</td><td>Yes</td><td></td><td></td></tr><tr><td>port</td><td>The starting port when creating the web services.  Web services will increment this port several  times to find an open port.  In the future the flexibility of this param will be expanded</td><td>yes</td><td></td><td></td></tr><tr><td>name</td><td>The Path of the api a user would call. The format is <code>hostname:port/name</code></td><td>yes</td><td></td><td></td></tr><tr><td>forwarding.enabled</td><td>Whether to forward the services to a gateway machine</td><td>no</td><td>false</td><td>When you need to forward services out of  a protected network. Only Supported for Continuous Serving.</td></tr><tr><td>forwarding.username</td><td>the username to connect to on the remote host</td><td>no</td><td></td><td></td></tr><tr><td>forwarding.sshport</td><td>the port to ssh connect to</td><td>no</td><td>22</td><td></td></tr><tr><td>forwarding.sshHost</td><td>the host of the gateway machine</td><td>no</td><td></td><td></td></tr><tr><td>forwarding.keySas</td><td>A Secure access link that can be used to automatically download the required ssh private key</td><td>no</td><td></td><td>Sometimes more convenient than a directory</td></tr><tr><td>forwarding.keyDir</td><td>A directory on the machines holding the private key</td><td>no</td><td>&quot;~/.ssh&quot;</td><td>Useful if you cannot send keys over the wire securely</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/SynapseML/docs/features/vw/Vowpal Wabbit - Overview/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Vowpal Wabbit - Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/SynapseML/docs/features/spark_serving/SparkServing - Deploying a Classifier/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SparkServing - Deploying a Classifier</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#an-engine-for-deploying-spark-jobs-as-distributed-web-services" class="table-of-contents__link toc-highlight">An Engine for Deploying Spark Jobs as Distributed Web Services</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#jupyter-notebook-examples" class="table-of-contents__link toc-highlight">Jupyter Notebook Examples</a></li><li><a href="#spark-serving-hello-world" class="table-of-contents__link toc-highlight">Spark Serving Hello World</a></li><li><a href="#deploying-a-deep-network-with-the-cntkmodel" class="table-of-contents__link toc-highlight">Deploying a Deep Network with the CNTKModel</a></li></ul></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a><ul><li><a href="#head-node-load-balanced" class="table-of-contents__link toc-highlight">Head Node Load Balanced</a></li><li><a href="#fully-distributed-custom-load-balancer" class="table-of-contents__link toc-highlight">Fully Distributed (Custom Load Balancer)</a></li><li><a href="#sub-millisecond-latency-with-continuous-processing" class="table-of-contents__link toc-highlight">Sub-Millisecond Latency with Continuous Processing</a></li></ul></li><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/getting_started/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/getting_started/first_example/">Getting Started</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/0.9.5/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python API Reference</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/0.9.5/scala/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scala API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/videos/">Videos</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Microsoft.</div></div></div></footer></div>
<script src="/SynapseML/assets/js/runtime~main.1b6b9565.js"></script>
<script src="/SynapseML/assets/js/main.96d01756.js"></script>
</body>
</html>