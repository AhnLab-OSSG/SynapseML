<!doctype html>
<html class="docs-version-0.9.1" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.7">
<link rel="alternate" type="application/rss+xml" href="/SynapseML/blog/rss.xml" title="Synapse ML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/SynapseML/blog/atom.xml" title="Synapse ML Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Synapse ML" href="/SynapseML/opensearch.xml"><title data-react-helmet="true">Http on Apache Spark | Synapse ML</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-react-helmet="true" name="twitter:image" content="https://microsoft.github.io/SynapseML/img/synapseml_og.jpg"><meta data-react-helmet="true" property="og:url" content="https://microsoft.github.io/SynapseML/docs/features/http/about/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.9.1"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.9.1"><meta data-react-helmet="true" property="og:title" content="Http on Apache Spark | Synapse ML"><meta data-react-helmet="true" name="description" content="A library for interacting with HTTP services from Apache Spark"><meta data-react-helmet="true" property="og:description" content="A library for interacting with HTTP services from Apache Spark"><link data-react-helmet="true" rel="shortcut icon" href="/SynapseML/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://microsoft.github.io/SynapseML/docs/features/http/about/"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/features/http/about/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io/SynapseML/docs/features/http/about/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/SynapseML/assets/css/styles.99df1580.css">
<link rel="preload" href="/SynapseML/assets/js/runtime~main.2dcb381a.js" as="script">
<link rel="preload" href="/SynapseML/assets/js/main.00d7a27b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1boX">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/SynapseML/"><div class="navbar__logo"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_3oOy themedImage--light_3ouy"><img src="/SynapseML/img/logo.svg" alt="SynapseML Logo" class="themedImage_3oOy themedImage--dark_3zJb"></div><b class="navbar__title">SynapseML</b></a><a class="navbar__item navbar__link" href="/SynapseML/docs/about/">Docs</a><a class="navbar__item navbar__link" href="/SynapseML/blog/">Blog</a><a class="navbar__item navbar__link" href="/SynapseML/videos/">Videos</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/SynapseML/docs/about/">0.9.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/SynapseML/docs/next/features/http/about/">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/SynapseML/docs/features/http/about/">0.9.1</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_tswG"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/SynapseML/docs/features/http/about/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">Developer Docs</a><ul class="dropdown__menu"><li><a href="https://mmlspark.blob.core.windows.net/docs/0.9.1/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Python<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://mmlspark.blob.core.windows.net/docs/0.9.1/scala/com/microsoft/azure/synapse/ml/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Scala<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_2iFN toggle_2ySP toggleChecked_XXXW toggleDisabled_1pbd"><div class="toggleTrack_1bVV" role="button" tabindex="-1"><div class="toggleTrackCheck_3GBG"><span class="toggleIcon_KBSf">ðŸŒœ</span></div><div class="toggleTrackX_1jae"><span class="toggleIcon_KBSf">ðŸŒž</span></div><div class="toggleTrackThumb_2_QT"></div></div><input type="checkbox" checked="" class="toggleScreenReader_32DE" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_3zOJ"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_DkI0" type="button"></button><aside class="docSidebarContainer_G8MK"><div class="sidebar_1tWv"><nav class="menu thin-scrollbar menu_1Iah"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/SynapseML/docs/about/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Features</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/features/CognitiveServices - Overview/">CognitiveServices - Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">HTTP on Spark</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/SynapseML/docs/features/http/about/">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/SynapseML/docs/features/http/HttpOnSpark - Working with Arbitrary Web APIs/">HttpOnSpark - Working with Arbitrary Web APIs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">LightGBM</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Model Interpretability</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ONNX</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Spark Serving</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Vowpal Wabbit</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Examples</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Transformers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Estimators</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_3Zec"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_2q91"><div class="docItemContainer_37q2"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->0.9.1</span><div class="tocCollapsible_3moT theme-doc-toc-mobile tocMobile_2bxg"><button type="button" class="clean-btn tocCollapsibleButton_3OYu">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>HTTP on Apache Spark</h1></header><h3 class="anchor anchorWithStickyNavbar_1iPN" id="a-library-for-interacting-with-http-services-from-apache-spark">A library for interacting with HTTP services from Apache Spark<a aria-hidden="true" class="hash-link" href="#a-library-for-interacting-with-http-services-from-apache-spark" title="Direct link to heading">â€‹</a></h3><ul><li><strong>Flexible</strong>: Encodes the entire HTTP protocol in Apache Spark for
full control of web requests</li><li><strong>Performant</strong>: Fully distributed across workers, built in support for
multi-threaded buffering, batching, and asynchronous request
concurrency.</li><li><strong>Easy to Use</strong>: High-level APIs for automatic parsing of requests,
abstracting all HTTP knowledge to under the hood.</li><li><strong>Accessible from Multiple Languages</strong>: Usable in Python and Scala.
Native integration with Scala&#x27;s Apache HTTP Core.  Native
integration with <a href="http://docs.python-requests.org/en/master/" target="_blank" rel="noopener noreferrer">Python Requests</a> library coming soon!</li><li><strong>Composable</strong>: Pipeline Stage APIs allow users to embed and compose
web services with SparkML machine learning models.</li></ul><h2 class="anchor anchorWithStickyNavbar_1iPN" id="usage">Usage<a aria-hidden="true" class="hash-link" href="#usage" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_1iPN" id="send-a-json-post-request">Send a JSON POST request<a aria-hidden="true" class="hash-link" href="#send-a-json-post-request" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB python"><pre tabindex="0" class="prism-code language-python codeBlock_1uaJ thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#f8f8f2"><span class="token keyword">import</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> synapse</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">ml</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">io</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">http </span><span class="token keyword">import</span><span class="token plain"> SimpleHTTPTransformer</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> JSONOutputParser</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">types </span><span class="token keyword">import</span><span class="token plain"> StructType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> StringType</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator">=</span><span class="token plain"> sc</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">parallelize</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">[</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> </span><span class="token keyword">for</span><span class="token plain"> x </span><span class="token keyword">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(174, 129, 255)">range</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">100</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">]</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">toDF</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;data&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">client </span><span class="token operator">=</span><span class="token plain"> SimpleHTTPTransformer</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setInputCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;data&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOutputParser</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">JSONOutputParser</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">                   </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setDataType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">StructType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">add</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;replies&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">,</span><span class="token plain"> StringType</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setUrl</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;www.my_service_url.com/any_api_here&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setOutputCol</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;results&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">responses </span><span class="token operator">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="high-performance-functionality">High-Performance Functionality<a aria-hidden="true" class="hash-link" href="#high-performance-functionality" title="Direct link to heading">â€‹</a></h2><p>The Simple HTTP transformer provides options for batching request bodies
and asynchronous request sending.  For simplicity and easier debugging,
these options are not enabled by default.</p><ul><li><p><code>maxBatchSize</code>: Parameter that enables buffered minibatching.  If this
parameter is set, a background thread will fetch up to at most
<code>maxBatchSize</code> requests.  These requests&#x27;s are combined by creating an
array of their entity data.  The method sends <em>up to</em> <code>maxBatchSize</code>
requests, rapid iterator materialization will result in smaller
batches as the background thread does not have enough time to
materialize a full batch.  In other words, each new request sends all
of the new data that has accumulated at this stage of the pipeline.</p></li><li><p><code>concurrency</code>: This parameter allows one to send up to <code>concurrency</code>
requests simultaneously using Scala futures under the hood.  If this
parameter is set to 1 (default), then no Scala futures are used.</p></li><li><p><code>concurrentTimeout</code>: If <code>concurrency</code>&gt;1, requests will fail if they do
not receive a response within <code>concurrentTimeout</code> seconds.</p></li><li><p><code>handlingStrategy</code>: (<code>&quot;basic&quot;</code>, or <code>&quot;advanced&quot;</code>) advanced handling
uses exponential backoff on the retires and can handle responses that
instruct clients to throttle or retry again.</p></li></ul><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB python"><pre tabindex="0" class="prism-code language-python codeBlock_1uaJ thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#f8f8f2"><span class="token plain">SimpleHTTPTransformer</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setMaxBatchSize</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">100</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setConcurrency</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">5</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setConcurrentTimeout</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token number" style="color:rgb(174, 129, 255)">30.0</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(249, 38, 114)">.</span><span class="token plain">setHandlingStrategy</span><span class="token punctuation" style="color:rgb(249, 38, 114)">(</span><span class="token string" style="color:rgb(230, 219, 116)">&quot;advanced&quot;</span><span class="token punctuation" style="color:rgb(249, 38, 114)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_1iPN" id="architecture">Architecture<a aria-hidden="true" class="hash-link" href="#architecture" title="Direct link to heading">â€‹</a></h2><p>HTTP on Spark encapsulates the entire HTTP protocol within Spark&#x27;s
datatypes.  Uses can create flexible web clients that communicate with a
wide variety of endpoints.  SynapseML provides methods to convert between
Scala case classes, Spark types, and Apache HTTP Core types.  A common
representation makes it easy to work with HTTP on spark from Scala,
Python, or any other spark compatible language.  This common
representation is serializable allowing for complex operations like SQL
joins and repartitons.</p><p>In HTTP on Spark, each partition manages a running web client that sends
requests.  A schematic representation can be seen below:</p><p align="center"><img src="/img/notebooks/HTTPOnSparkArchitecture.png" width="600"></p><h2 class="anchor anchorWithStickyNavbar_1iPN" id="schema">Schema<a aria-hidden="true" class="hash-link" href="#schema" title="Direct link to heading">â€‹</a></h2><p>This library adds Spark types that faithfully represent the HTTP
protocol for requests and responses.  SynapseML provides several ways to
create these objects from the apache HTTP core library, and from a set
of case classes.</p><p>The schema for a complete HTTP request looks like:</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB"><pre tabindex="0" class="prism-code language-undefined codeBlock_1uaJ thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#f8f8f2"><span class="token plain">request: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- requestLine: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- method: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- uri: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- protoclVersion: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- protocol: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- major: integer (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- minor: integer (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- headers: array (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- element: struct (containsNull = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- value: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- entity: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- content: binary (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- contentEncoding: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      |    +-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      |    +-- value: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- contentLenth: long (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- contentType: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      |    +-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      |    +-- value: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- isChunked: boolean (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- isRepeatable: boolean (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain">      +-- isStreaming: boolean (nullable = false)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div><p>And the schema for a complete response looks like:</p><div class="codeBlockContainer_21wf"><div class="codeBlockContent_1izB"><pre tabindex="0" class="prism-code language-undefined codeBlock_1uaJ thin-scrollbar" style="color:#f8f8f2;background-color:#272822"><code class="codeBlockLines_3_dS"><span class="token-line" style="color:#f8f8f2"><span class="token plain">response: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- headers: array (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- element: struct (containsNull = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |         +-- value: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- entity: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- content: binary (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- contentEncoding: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- value: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- contentLenth: long (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- contentType: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- name: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- value: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- isChunked: boolean (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- isRepeatable: boolean (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- isStreaming: boolean (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- statusLine: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- protocolVersion: struct (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- protocol: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- major: integer (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    |    +-- minor: integer (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- statusCode: integer (nullable = false)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> |    +-- reasonPhrase: string (nullable = true)</span><br></span><span class="token-line" style="color:#f8f8f2"><span class="token plain"> +-- locale: string (nullable = true)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_3XUZ clean-btn">Copy</button></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/SynapseML/docs/features/CognitiveServices - Overview/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->CognitiveServices - Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/SynapseML/docs/features/http/HttpOnSpark - Working with Arbitrary Web APIs/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">HttpOnSpark - Working with Arbitrary Web APIs<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_2pwG thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#a-library-for-interacting-with-http-services-from-apache-spark" class="table-of-contents__link toc-highlight">A library for interacting with HTTP services from Apache Spark</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#send-a-json-post-request" class="table-of-contents__link toc-highlight">Send a JSON POST request</a></li></ul></li><li><a href="#high-performance-functionality" class="table-of-contents__link toc-highlight">High-Performance Functionality</a></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#schema" class="table-of-contents__link toc-highlight">Schema</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/getting_started/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/docs/getting_started/first_example/">Getting Started</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/0.9.1/pyspark/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python API Reference</a></li><li class="footer__item"><a href="https://mmlspark.blob.core.windows.net/docs/0.9.1/scala/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Scala API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/SynapseML/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/SynapseML/videos/">Videos</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/microsoft/SynapseML" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_37dV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Microsoft.</div></div></div></footer></div>
<script src="/SynapseML/assets/js/runtime~main.2dcb381a.js"></script>
<script src="/SynapseML/assets/js/main.00d7a27b.js"></script>
</body>
</html>